<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<title>Test DryValidator in a browser</title>
	<script type="text/javascript">var dryValidatorModuleName="DV";</script>
	<script type="text/javascript" src="jquery.js"></script>
	<script type="text/javascript" src="../../../src/main/resources/com/google/codes/dryvalidator/joose.js"></script>
	<script type="text/javascript" src="../../../src/main/resources/com/google/codes/dryvalidator/dry-validator.js"></script>
</head>
<body>
	<h1>Test</h1>
	<div id="messageArea">
	</div>
	<form id="sampleForm">
		<table summary="person">
			<tr>
				<th>氏名</th>
				<td>氏<input type="text" name="familyName"/>名<input type="text" name="firstName"/></td>
			</tr>
		</table>
		<button type="button" id="doValidate">Validate It</button>
	</form>
	<script type="text/javascript">
<!--
$(document).ready(function() {
	var validators = {};
	$.ajax({
		url:'/formItem',
		success: function(data) {
			$.each(data, function(i, formItem) {
				var validation = {label: formItem.label};
				Joose.A.each(formItem.validations.validation, function(v) { validation[v.name] = v.value; });
				validators[formItem.id] = DV.CompositeValidator.make(validation);
			});
		}, error: function(request, stat, t) {
			console.error("error:"+stat);
		}
	});

	$("#doValidate").click(function(){
		var form = new DV.Form().setup("sampleForm");
		var msg = form.validateAll(validators);

		var ul = $("<ul/>").appendTo($("#messageArea").empty());
		for(var key in msg) {
			for (var i=0; i<msg[key].length; i++) {
				$("<li/>").text(msg[key][i]).appendTo(ul);
			}
		}
	});
});
--></script>
</body>
</html>